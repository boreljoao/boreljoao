document.addEventListener('DOMContentLoaded', () => {
    // ===============================
    // Loader
    // ===============================
    const loader = document.querySelector('.loader');

    const hideLoader = () => {
        if (loader) {
            loader.style.opacity = '0';
            loader.style.visibility = 'hidden';

            setTimeout(() => {
                document.body.classList.add('body--active');
            }, 500);
        }
    };
    window.addEventListener('load', () => {
        const loader = document.querySelector('.loader');
        if (loader) {
            loader.style.opacity = '0';
            loader.style.visibility = 'hidden';
    
            // Ativa o conteúdo após carregamento
            setTimeout(() => {
                document.body.classList.add('body--active');
            }, 500);
        }
    });
    
    // Esconde loader quando a página terminar de carregar
    window.addEventListener('load', hideLoader);

    // Garante que loader e conteúdo reaparecem ao voltar do histórico
    window.addEventListener('pageshow', () => {
        hideLoader();
        document.body.style.opacity = '1';
        document.body.classList.add('body--active');
    });

    // ===============================
    // Cursor personalizado
    // ===============================
    const cursor = document.querySelector('.cursor');
    const cursorFollower = document.querySelector('.cursor-follower');

    if (cursor && cursorFollower) {
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';

            setTimeout(() => {
                cursorFollower.style.left = e.clientX + 'px';
                cursorFollower.style.top = e.clientY + 'px';
            }, 100);
        });

        const interactiveElements = document.querySelectorAll('a, button, .service-card, .skill-item');
        interactiveElements.forEach(el => {
            el.addEventListener('mouseenter', () => {
                cursor.style.transform = 'translate(-50%, -50%) scale(1.5)';
                cursor.style.opacity = '0.5';
                cursorFollower.style.transform = 'translate(-50%, -50%) scale(1.5)';
            });
            el.addEventListener('mouseleave', () => {
                cursor.style.transform = 'translate(-50%, -50%) scale(1)';
                cursor.style.opacity = '1';
                cursorFollower.style.transform = 'translate(-50%, -50%) scale(1)';
            });
        });
    }

    // ===============================
    // ScrollReveal
    // ===============================
    if (typeof ScrollReveal !== 'undefined') {
        const sr = ScrollReveal({
            origin: 'top',
            distance: '50px',
            duration: 1000,
            delay: 200,
            easing: 'cubic-bezier(0.5, 0, 0, 1)',
            reset: false
        });

        sr.reveal('.sidebar', { origin: 'left', delay: 300 });
        sr.reveal('.navigation__link', { interval: 150, origin: 'right' });
    }

    // ===============================
    // Intersection Observer
    // ===============================
    if ('IntersectionObserver' in window) {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate');
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.navigation__link').forEach(link => {
            observer.observe(link);
        });
    }

    // ===============================
    // Transição suave entre páginas
    // ===============================
    // Transição suave entre páginas com loader visível
document.querySelectorAll('a[href$=".html"]').forEach(link => {
    link.addEventListener('click', (e) => {
        if (!link.hash && link.target !== '_blank') {
            e.preventDefault();

            // Mostra o loader imediatamente
            const loader = document.querySelector('.loader');
            if (loader) {
                loader.style.opacity = '1';
                loader.style.visibility = 'visible';
            }

            // Aguarda um pouco para transição visual, depois muda de página
            setTimeout(() => {
                window.location.href = link.href;
            }, 300); // tempo suficiente para mostrar o loader
        }
    });
});


    // ===============================
    // Lazy load para imagens
    // ===============================
    if ('loading' in HTMLImageElement.prototype) {
        document.querySelectorAll('img[loading="lazy"]').forEach(img => {
            if (img.dataset.src) {
                img.src = img.dataset.src;
            }
        });
    }
});

// ===============================
// Atualiza o ano no rodapé
// ===============================
const yearElement = document.getElementById('current-year');
if (yearElement) {
    yearElement.textContent = new Date().getFullYear();
}

// ===============================
// Efeito hover na logo
// ===============================
const logoLink = document.querySelector('.logo-link');
if (logoLink) {
    logoLink.addEventListener('mouseenter', () => {
        logoLink.style.transform = 'rotate(5deg)';
    });
    logoLink.addEventListener('mouseleave', () => {
        logoLink.style.transform = 'rotate(0)';
    });
}
